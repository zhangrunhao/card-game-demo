export const messages = {
  en: {
    "app.title": "Card Duel",
    "toggle.theme.dark": "Night",
    "toggle.theme.light": "Day",
    "toggle.lang.zh": "中文",
    "toggle.lang.en": "English",
    "player.guest": "Player",
    "entry.eyebrow": "Card Duel",
    "entry.title": "Choose Your Match",
    "entry.subtitle": "Jump into the lobby or challenge the bot right away.",
    "entry.choice_human_tag": "Multiplayer",
    "entry.choice_human": "Play vs Players",
    "entry.choice_human_desc": "Enter the room lobby and join a waiting match.",
    "entry.choice_human_action": "Enter Lobby",
    "entry.choice_bot_tag": "Solo",
    "entry.choice_bot": "Play vs Bot",
    "entry.choice_bot_desc": "Start a duel instantly with a robot opponent.",
    "entry.choice_bot_action": "Start Duel",
    "lobby.eyebrow": "Room Lobby",
    "lobby.title": "Pick a Room",
    "lobby.subtitle": "Open rooms are waiting for players.",
    "lobby.name_label": "Your Name",
    "lobby.name_placeholder": "e.g. Alex",
    "lobby.action.create": "Create Room",
    "lobby.action.bot": "Play vs Bot",
    "lobby.action.back": "Back to Home",
    "lobby.rooms.title": "Rooms",
    "lobby.rooms.subtitle": "Click a room that hasn't started yet.",
    "lobby.rooms.stats_total": "Total",
    "lobby.rooms.stats_waiting": "Waiting",
    "lobby.rooms.stats_playing": "Playing",
    "lobby.rooms.empty": "No rooms yet. Create the first one.",
    "lobby.room.players": "Players",
    "lobby.room.empty_players": "Waiting for players",
    "lobby.room.join": "Join",
    "lobby.room.full": "Full",
    "lobby.room.bot": "Bot Match",
    "lobby.status.waiting": "not started",
    "lobby.status.playing": "started",
    "lobby.status.finished": "finished",
    "lobby.error.name_required": "Please enter your name.",
    "lobby.error.room_not_found": "Room not found. Refresh and try again.",
    "lobby.error.room_full": "Room is full.",
    "lobby.error.room_finished": "Room already finished.",
    "lobby.error.fetch": "Failed to load rooms. Try again soon.",
    "lobby.error.generic": "Unable to join the room. Please try again.",
    "lobby.loading": "Loading rooms...",
    "create.eyebrow": "Create Room",
    "create.title": "Start a New Match",
    "create.subtitle": "Enter your name to generate a room.",
    "create.player_name": "Player Name",
    "create.player_placeholder": "e.g. Alex",
    "create.error.name_required": "Player name is required.",
    "create.back": "Back to Lobby",
    "create.confirm": "Create Room",
    "create.bot": "Robot Challenge",
    "match.eyebrow": "Matching Room",
    "match.title": "Finding an Opponent",
    "match.subtitle": "Stay on this screen while we match you.",
    "match.label.room": "Room",
    "match.label.player": "Player",
    "match.label.user_id": "User ID",
    "match.label.players": "Players",
    "match.label.status": "Status",
    "match.label.wait_time": "Wait Time",
    "match.pending": "pending",
    "match.empty": "Missing room or player info. Please return to the lobby.",
    "match.back": "Back to Lobby",
    "match.seconds": "s",
    "status.waiting": "waiting",
    "status.playing": "playing",
    "status.finished": "finished",
    "battle.round": "Round",
    "battle.title": "Duel in Progress",
    "battle.subtitle": "Choose a card and wait for your opponent. HP has no upper limit.",
    "battle.current": "Current",
    "battle.back": "Back to Lobby",
    "battle.you": "You",
    "battle.opponent": "Opponent",
    "battle.id": "ID",
    "battle.hp": "HP",
    "battle.choose_card": "Choose Your Card",
    "battle.waiting": "Waiting for opponent",
    "battle.your_move": "Your move",
    "battle.locked": "Card locked in. Await the other player.",
    "battle.pick": "Pick a card to submit.",
    "battle.selected": "Selected",
    "battle.latest_result": "Latest Result",
    "battle.result": "Result",
    "battle.net": "Net",
    "battle.results_pending": "Results will appear after both players act.",
    "battle.unknown": "Unknown",
    "battle.pending": "pending",
    "battle.confirm": "Confirm",
    "battle.vs": "VS",
    "battle.status_both_pending_title": "Both players haven't chosen yet",
    "battle.status_both_pending_text": "Pick a card to submit.",
    "battle.status_waiting_title": "Card locked in. Waiting for opponent",
    "battle.status_waiting_text": "Opponent hasn't chosen yet.",
    "battle.status_prompt_title": "Opponent has chosen. Your turn",
    "battle.status_prompt_text": "Pick a card now.",
    "battle.status_reveal_title": "Both players chose. Revealing",
    "battle.status_reveal_text": "Revealing this round's result.",
    "action.attack": "Attack",
    "action.defend": "Defend",
    "action.rest": "Rest",
    "action.attack_desc": "HP (you/opponent): vs Attack -2/-2, vs Defend -1/0, vs Rest +1/-2.",
    "action.defend_desc": "HP (you/opponent): vs Attack 0/-1, vs Defend -1/-1, vs Rest 0/+1.",
    "action.rest_desc": "HP (you/opponent): vs Attack -2/+1, vs Defend +1/0, vs Rest 0/0.",
    "result.eyebrow": "Game Over",
    "result.draw": "Draw",
    "result.victory": "Victory",
    "result.defeat": "Defeat",
    "result.p1_win": "Player 1 Wins",
    "result.p2_win": "Player 2 Wins",
    "result.reason_zero": "HP reached 0",
    "result.reason_rounds": "10 rounds complete",
    "result.player_hp": "Your HP",
    "result.opponent_hp": "Opponent HP",
    "result.player1_hp": "Player 1 HP",
    "result.player2_hp": "Player 2 HP",
    "result.your_id": "Your ID",
    "result.round": "Round",
    "result.back": "Back to Lobby",
    "result.rematch": "Rematch",
    "result.unknown": "unknown",
  },
  zh: {
    "app.title": "卡牌对决",
    "toggle.theme.dark": "夜间",
    "toggle.theme.light": "日间",
    "toggle.lang.zh": "中文",
    "toggle.lang.en": "English",
    "player.guest": "玩家",
    "entry.eyebrow": "卡牌对决",
    "entry.title": "选择对战方式",
    "entry.subtitle": "进入房间大厅或立即挑战机器人。",
    "entry.choice_human_tag": "多人对战",
    "entry.choice_human": "与人对战",
    "entry.choice_human_desc": "进入房间大厅，选择未开始的房间。",
    "entry.choice_human_action": "进入大厅",
    "entry.choice_bot_tag": "单人挑战",
    "entry.choice_bot": "与机器人对战",
    "entry.choice_bot_desc": "立刻开始对战，匹配机器人。",
    "entry.choice_bot_action": "立即开战",
    "lobby.eyebrow": "房间大厅",
    "lobby.title": "选择一个房间",
    "lobby.subtitle": "未开始的房间可加入。",
    "lobby.name_label": "你的昵称",
    "lobby.name_placeholder": "例如 小明",
    "lobby.action.create": "创建房间",
    "lobby.action.bot": "与机器人对战",
    "lobby.action.back": "返回首页",
    "lobby.rooms.title": "房间列表",
    "lobby.rooms.subtitle": "点击未开始的房间进入对战。",
    "lobby.rooms.stats_total": "总数",
    "lobby.rooms.stats_waiting": "未开始",
    "lobby.rooms.stats_playing": "已开始",
    "lobby.rooms.empty": "暂时没有房间，创建一个新的吧。",
    "lobby.room.players": "玩家",
    "lobby.room.empty_players": "等待玩家加入",
    "lobby.room.join": "加入",
    "lobby.room.full": "已满",
    "lobby.room.bot": "机器人对战",
    "lobby.status.waiting": "未开始",
    "lobby.status.playing": "已开始",
    "lobby.status.finished": "已结束",
    "lobby.error.name_required": "请填写昵称。",
    "lobby.error.room_not_found": "房间不存在，请刷新后重试。",
    "lobby.error.room_full": "房间已满。",
    "lobby.error.room_finished": "房间已结束。",
    "lobby.error.fetch": "房间列表获取失败，请稍后重试。",
    "lobby.error.generic": "加入房间失败，请稍后重试。",
    "lobby.loading": "正在加载房间...",
    "create.eyebrow": "创建房间",
    "create.title": "开始新的对局",
    "create.subtitle": "输入昵称以生成房间。",
    "create.player_name": "玩家昵称",
    "create.player_placeholder": "例如 小明",
    "create.error.name_required": "请填写玩家昵称。",
    "create.back": "返回大厅",
    "create.confirm": "创建房间",
    "create.bot": "机器人挑战",
    "match.eyebrow": "匹配房间",
    "match.title": "寻找对手",
    "match.subtitle": "请保持在此页面等待匹配。",
    "match.label.room": "房间",
    "match.label.player": "玩家",
    "match.label.user_id": "用户ID",
    "match.label.players": "玩家数",
    "match.label.status": "状态",
    "match.label.wait_time": "等待时间",
    "match.pending": "等待中",
    "match.empty": "缺少房间或玩家信息，请返回大厅。",
    "match.back": "返回大厅",
    "match.seconds": "秒",
    "status.waiting": "等待中",
    "status.playing": "进行中",
    "status.finished": "已结束",
    "battle.round": "回合",
    "battle.title": "对决进行中",
    "battle.subtitle": "选择卡牌并等待对手。生命值不设上限。",
    "battle.current": "当前",
    "battle.back": "返回大厅",
    "battle.you": "你",
    "battle.opponent": "对手",
    "battle.id": "ID",
    "battle.hp": "生命",
    "battle.choose_card": "选择你的卡牌",
    "battle.waiting": "等待对手",
    "battle.your_move": "轮到你了",
    "battle.locked": "卡牌已锁定，等待对手。",
    "battle.pick": "请选择一张卡牌提交。",
    "battle.selected": "已选择",
    "battle.latest_result": "最新结果",
    "battle.result": "结果",
    "battle.net": "净变化",
    "battle.results_pending": "双方出牌后显示结果。",
    "battle.unknown": "未知",
    "battle.pending": "等待中",
    "battle.confirm": "确认",
    "battle.vs": "VS",
    "battle.status_both_pending_title": "双方都未出牌",
    "battle.status_both_pending_text": "请选择一张卡牌提交。",
    "battle.status_waiting_title": "你已出牌，等待对手",
    "battle.status_waiting_text": "对手尚未出牌。",
    "battle.status_prompt_title": "对手已出牌，轮到你了",
    "battle.status_prompt_text": "请立即选择一张卡牌提交。",
    "battle.status_reveal_title": "双方已出牌，正在开牌",
    "battle.status_reveal_text": "正在揭示本回合结果。",
    "action.attack": "进攻",
    "action.defend": "防守",
    "action.rest": "休养",
    "action.attack_desc": "HP 变化（你/对手）：对进攻 -2/-2，对防守 -1/0，对休养 +1/-2。",
    "action.defend_desc": "HP 变化（你/对手）：对进攻 0/-1，对防守 -1/-1，对休养 0/+1。",
    "action.rest_desc": "HP 变化（你/对手）：对进攻 -2/+1，对防守 +1/0，对休养 0/0。",
    "result.eyebrow": "对局结束",
    "result.draw": "平局",
    "result.victory": "胜利",
    "result.defeat": "失败",
    "result.p1_win": "玩家1获胜",
    "result.p2_win": "玩家2获胜",
    "result.reason_zero": "生命值归零",
    "result.reason_rounds": "10 回合结束",
    "result.player_hp": "你的生命",
    "result.opponent_hp": "对手生命",
    "result.player1_hp": "玩家1生命",
    "result.player2_hp": "玩家2生命",
    "result.your_id": "你的ID",
    "result.round": "回合",
    "result.back": "返回大厅",
    "result.rematch": "再来一局",
    "result.unknown": "未知",
  },
} as const;

export type Language = keyof typeof messages;
export type MessageKey = keyof typeof messages.en;
export type Translator = (key: MessageKey) => string;

export const languageStorageKey = "card_duel_lang";

export const getPreferredLanguage = (): Language => {
  if (typeof window === "undefined") {
    return "zh";
  }

  let stored: string | null = null;
  try {
    stored = window.localStorage.getItem(languageStorageKey);
  } catch (error) {
    stored = null;
  }

  if (stored === "en" || stored === "zh") {
    return stored;
  }

  return "zh";
};

export const createTranslator = (language: Language): Translator => {
  const table = messages[language] as Record<MessageKey, string>;
  return (key) => table[key] ?? messages.en[key] ?? key;
};
